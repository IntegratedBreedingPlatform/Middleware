<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
		http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.5.xsd">

	<changeSet author="cheryleigh" id="v23.4.0-1">
		<preConditions onFail="MARK_RAN">
			<sqlCheck expectedResult="0">
					SELECT count(*) FROM feedback WHERE feature = 'ADVANCE_GERMPLASM';
			</sqlCheck>
		</preConditions>
		<comment>
			Add 'ADVANCE_GERMPLASM' feature to 'feedback' table
		</comment>
		<sql dbms="mysql" splitStatements="true">
			INSERT INTO feedback (feature, collector_id, attempts, enabled) VALUES ('ADVANCE_GERMPLASM', 'qhejbh9p', 1, true);
		</sql>
	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-2">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'CREATE_STUDIES';
             </sqlCheck>
 		</preConditions>
		<comment>Add Create Studies permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @mg_studies_permission_id = (SELECT permission_id FROM permission WHERE name = 'MANAGE_STUDIES');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('CREATE_STUDIES', 'Create Studies', @mg_studies_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'CREATE_STUDIES');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-3">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'CLOSE_STUDY';
             </sqlCheck>
 		</preConditions>
		<comment>Add Close Study permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @mg_studies_permission_id = (SELECT permission_id FROM permission WHERE name = 'MANAGE_STUDIES');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('CLOSE_STUDY', 'Close Study', @mg_studies_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'CLOSE_STUDY');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-4">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'DELETE_STUDY';
             </sqlCheck>
 		</preConditions>
		<comment>Add Delete Study permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @mg_studies_permission_id = (SELECT permission_id FROM permission WHERE name = 'MANAGE_STUDIES');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('DELETE_STUDY', 'Delete Study', @mg_studies_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'DELETE_STUDY');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-5">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'LOCK_STUDY';
             </sqlCheck>
 		</preConditions>
		<comment>Add Lock Study permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @mg_studies_permission_id = (SELECT permission_id FROM permission WHERE name = 'MANAGE_STUDIES');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('LOCK_STUDY', 'Lock Study', @mg_studies_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'LOCK_STUDY');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-6">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_GERMPLASM_AND_CHECKS';
             </sqlCheck>
 		</preConditions>
		<comment>Add Germplasm and Checks permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @mg_studies_permission_id = (SELECT permission_id FROM permission WHERE name = 'MANAGE_STUDIES');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_GERMPLASM_AND_CHECKS', 'Germplasm and Checks', @mg_studies_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_GERMPLASM_AND_CHECKS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-7">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_VIEW_GERMPLASM_AND_CHECKS';
             </sqlCheck>
 		</preConditions>
		<comment>Add View Germplasm and Checks permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_germplasm_and_checks_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_GERMPLASM_AND_CHECKS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_VIEW_GERMPLASM_AND_CHECKS', 'View Germplasm and Checks', @ms_germplasm_and_checks_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_VIEW_GERMPLASM_AND_CHECKS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-8">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_ADD_ENTRY_DETAILS_VARIABLES';
             </sqlCheck>
 		</preConditions>
		<comment>Add Entry Details Variables permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_germplasm_and_checks_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_GERMPLASM_AND_CHECKS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_ADD_ENTRY_DETAILS_VARIABLES', 'Add Entry Details Variables', @ms_germplasm_and_checks_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_ADD_ENTRY_DETAILS_VARIABLES');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-9">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_MODIFY_ENTRY_DETAILS_VALUES';
             </sqlCheck>
 		</preConditions>
		<comment>Add Modify Entry Details Values permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_germplasm_and_checks_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_GERMPLASM_AND_CHECKS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_MODIFY_ENTRY_DETAILS_VALUES', 'Modify Entry Details Values', @ms_germplasm_and_checks_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_MODIFY_ENTRY_DETAILS_VALUES');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-10">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_MODIFY_COLUMNS';
             </sqlCheck>
 		</preConditions>
        <comment>Add Modify Columns permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_germplasm_and_checks_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_GERMPLASM_AND_CHECKS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_MODIFY_COLUMNS', 'Modify Columns', @ms_germplasm_and_checks_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_MODIFY_COLUMNS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-11">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_REPLACE_GERMPLASM';
             </sqlCheck>
 		</preConditions>
		<comment>Add Replace Germplasm permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_germplasm_and_checks_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_GERMPLASM_AND_CHECKS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_REPLACE_GERMPLASM', 'Replace Germplasm', @ms_germplasm_and_checks_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_REPLACE_GERMPLASM');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-12">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_ADD_NEW_ENTRIES';
             </sqlCheck>
 		</preConditions>
		<comment>Add New Entries permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_germplasm_and_checks_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_GERMPLASM_AND_CHECKS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_ADD_NEW_ENTRIES', 'Add New Entries', @ms_germplasm_and_checks_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_ADD_NEW_ENTRIES');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-13">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_IMPORT_ENTRY_DETAILS';
             </sqlCheck>
 		</preConditions>
        <comment>Add Import Entry Details permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_germplasm_and_checks_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_GERMPLASM_AND_CHECKS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_IMPORT_ENTRY_DETAILS', 'Import Entry Details', @ms_germplasm_and_checks_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_IMPORT_ENTRY_DETAILS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-14">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_TREATMENT_FACTORS';
             </sqlCheck>
 		</preConditions>
        <comment>Add Treatment Factors permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @mg_studies_permission_id = (SELECT permission_id FROM permission WHERE name = 'MANAGE_STUDIES');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_TREATMENT_FACTORS', 'Treatment Factors', @mg_studies_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_TREATMENT_FACTORS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-15">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_VIEW_TREATMENT_FACTORS';
             </sqlCheck>
 		</preConditions>
		<comment>Add View Treatment Factors permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_treatment_factors_id = (SELECT permission_id FROM permission WHERE name = 'MS_TREATMENT_FACTORS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_VIEW_TREATMENT_FACTORS', 'View Treatment Factors', @ms_treatment_factors_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_VIEW_TREATMENT_FACTORS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-16">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_ADD_TREATMENT_FACTORS_VARIABLES';
             </sqlCheck>
 		</preConditions>
		<comment>Add Treatment Factors Variables permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_treatment_factors_id = (SELECT permission_id FROM permission WHERE name = 'MS_TREATMENT_FACTORS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_ADD_TREATMENT_FACTORS_VARIABLES', 'Add Treatment Factors Variables', @ms_treatment_factors_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_ADD_TREATMENT_FACTORS_VARIABLES');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-17">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_EXPERIMENTAL_DESIGN';
             </sqlCheck>
 		</preConditions>
        <comment>Add Experimental Design permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @mg_studies_permission_id = (SELECT permission_id FROM permission WHERE name = 'MANAGE_STUDIES');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_EXPERIMENTAL_DESIGN', 'Experimental Design', @mg_studies_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_EXPERIMENTAL_DESIGN');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-18">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_VIEW_EXPERIMENTAL_DESIGN';
             </sqlCheck>
 		</preConditions>
		<comment>Add View Experimental Design permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_experimental_design_id = (SELECT permission_id FROM permission WHERE name = 'MS_EXPERIMENTAL_DESIGN');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_VIEW_EXPERIMENTAL_DESIGN', 'View Experimental Design', @ms_experimental_design_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_VIEW_EXPERIMENTAL_DESIGN');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-19">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_GENERATE_EXPERIMENTAL_DESIGN';
             </sqlCheck>
 		</preConditions>
		<comment>Add Generate Experimental Design permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_experimental_design_id = (SELECT permission_id FROM permission WHERE name = 'MS_EXPERIMENTAL_DESIGN');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_GENERATE_EXPERIMENTAL_DESIGN', 'Generate Experimental Design', @ms_experimental_design_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_GENERATE_EXPERIMENTAL_DESIGN');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-20">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_DELETE_EXPERIMENTAL_DESIGN';
             </sqlCheck>
 		</preConditions>
		<comment>Add Delete Experimental Design permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_experimental_design_id = (SELECT permission_id FROM permission WHERE name = 'MS_EXPERIMENTAL_DESIGN');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_DELETE_EXPERIMENTAL_DESIGN', 'Delete Experimental Design', @ms_experimental_design_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_DELETE_EXPERIMENTAL_DESIGN');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-21">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_ENVIRONMENT';
             </sqlCheck>
 		</preConditions>
        <comment>Add Environment permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @mg_studies_permission_id = (SELECT permission_id FROM permission WHERE name = 'MANAGE_STUDIES');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_ENVIRONMENT', 'Environments', @mg_studies_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_ENVIRONMENT');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-22">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_VIEW_ENVIRONMENT';
             </sqlCheck>
 		</preConditions>
		<comment>Add View Environment permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_environment_id = (SELECT permission_id FROM permission WHERE name = 'MS_ENVIRONMENT');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_VIEW_ENVIRONMENT', 'View Environment', @ms_environment_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_VIEW_ENVIRONMENT');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-23">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_ADD_ENVIRONMENTAL_CONDITIONS_VARIABLES';
             </sqlCheck>
 		</preConditions>
		<comment>Add Environmental Conditions Variables permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_environment_id = (SELECT permission_id FROM permission WHERE name = 'MS_ENVIRONMENT');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_ADD_ENVIRONMENTAL_CONDITIONS_VARIABLES', 'Add Environmental Conditions Variables', @ms_environment_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_ADD_ENVIRONMENTAL_CONDITIONS_VARIABLES');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-24">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_ADD_ENVIRONMENT_DETAILS_VARIABLES';
             </sqlCheck>
 		</preConditions>
		<comment>Add Environment Details Variables permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_environment_id = (SELECT permission_id FROM permission WHERE name = 'MS_ENVIRONMENT');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_ADD_ENVIRONMENT_DETAILS_VARIABLES', 'Add Environment Details Variables', @ms_environment_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_ADD_ENVIRONMENT_DETAILS_VARIABLES');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-25">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_MODIFY_ENVIRONMENT_VALUES';
             </sqlCheck>
 		</preConditions>
		<comment>Add Modify Environment Values permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_environment_id = (SELECT permission_id FROM permission WHERE name = 'MS_ENVIRONMENT');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_MODIFY_ENVIRONMENT_VALUES', 'Modify Environment Values', @ms_environment_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_MODIFY_ENVIRONMENT_VALUES');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-26">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_MODIFY_NUMBER_OF_ENVIRONMENTS';
             </sqlCheck>
 		</preConditions>
		<comment>Add Modify Number of Environment permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_environment_id = (SELECT permission_id FROM permission WHERE name = 'MS_ENVIRONMENT');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_MODIFY_NUMBER_OF_ENVIRONMENTS', 'Modify Number of Environments', @ms_environment_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_MODIFY_NUMBER_OF_ENVIRONMENTS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-27">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_MANAGE_FILES_ENVIRONMENT';
             </sqlCheck>
 		</preConditions>
		<comment>Add Manage Files Environment permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_environment_id = (SELECT permission_id FROM permission WHERE name = 'MS_ENVIRONMENT');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_MANAGE_FILES_ENVIRONMENT', 'Manage Files Environment', @ms_environment_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_MANAGE_FILES_ENVIRONMENT');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-28">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_STUDY_SETTINGS';
             </sqlCheck>
 		</preConditions>
        <comment>Add Study Settings permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @mg_studies_permission_id = (SELECT permission_id FROM permission WHERE name = 'MANAGE_STUDIES');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_STUDY_SETTINGS', 'Study Settings', @mg_studies_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_STUDY_SETTINGS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-29">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_VIEW_STUDY_SETTINGS';
             </sqlCheck>
 		</preConditions>
		<comment>Add View Settings permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_study_settings = (SELECT permission_id FROM permission WHERE name = 'MS_STUDY_SETTINGS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_VIEW_STUDY_SETTINGS', 'View Study Settings', @ms_study_settings);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_VIEW_STUDY_SETTINGS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-30">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_ADD_STUDY_SETTINGS_VARIABLES';
             </sqlCheck>
 		</preConditions>
		<comment>Add Settings Variables permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_study_settings = (SELECT permission_id FROM permission WHERE name = 'MS_STUDY_SETTINGS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_ADD_STUDY_SETTINGS_VARIABLES', 'Add Study Settings Variables', @ms_study_settings);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_ADD_STUDY_SETTINGS_VARIABLES');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-31">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_CROSSES_AND_SELECTIONS';
             </sqlCheck>
 		</preConditions>
        <comment>Add Crosses and Selections permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @mg_studies_permission_id = (SELECT permission_id FROM permission WHERE name = 'MANAGE_STUDIES');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_CROSSES_AND_SELECTIONS', 'Crosses and Selections', @mg_studies_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_CROSSES_AND_SELECTIONS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-32">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_VIEW_CROSSES_AND_SELECTIONS';
             </sqlCheck>
 		</preConditions>
		<comment>Add View Crosses and Selections permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @mg_crosses_and_selections_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_CROSSES_AND_SELECTIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_VIEW_CROSSES_AND_SELECTIONS', 'View Crosses and Selections', @mg_crosses_and_selections_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_VIEW_CROSSES_AND_SELECTIONS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-33">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_INVENTORY';
             </sqlCheck>
 		</preConditions>
        <comment>Add Study Inventory permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @mg_studies_permission_id = (SELECT permission_id FROM permission WHERE name = 'MANAGE_STUDIES');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_INVENTORY', 'Inventory', @mg_studies_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_INVENTORY');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-34">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_VIEW_INVENTORY';
             </sqlCheck>
 		</preConditions>
		<comment>Add View Study Inventory permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @mg_inventory_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_INVENTORY');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_VIEW_INVENTORY', 'View Inventory', @mg_inventory_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_VIEW_INVENTORY');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-35">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_SAMPLE_LISTS';
             </sqlCheck>
 		</preConditions>
        <comment>Add Study Sample List permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @mg_studies_permission_id = (SELECT permission_id FROM permission WHERE name = 'MANAGE_STUDIES');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_SAMPLE_LISTS', 'Sample Lists', @mg_studies_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_SAMPLE_LISTS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-36">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_VIEW_SAMPLE_LISTS';
             </sqlCheck>
 		</preConditions>
		<comment>Add View Sample List permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @mg_sample_list_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_SAMPLE_LISTS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_VIEW_SAMPLE_LISTS', 'View Sample Lists', @mg_sample_list_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_VIEW_SAMPLE_LISTS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-37">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_EXPORT_SAMPLE_LIST';
             </sqlCheck>
 		</preConditions>
		<comment>Add Export Sample List permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @mg_sample_list_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_SAMPLE_LISTS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_EXPORT_SAMPLE_LIST', 'Export Sample List', @mg_sample_list_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_EXPORT_SAMPLE_LIST');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-38">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_DELETE_SAMPLES';
             </sqlCheck>
 		</preConditions>
		<comment>Add Delete Samples permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @mg_sample_list_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_SAMPLE_LISTS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_DELETE_SAMPLES', 'Delete Samples', @mg_sample_list_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_DELETE_SAMPLES');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-39">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_IMPORT_GENOTYPES';
             </sqlCheck>
 		</preConditions>
		<comment>Add Import Genotypes permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @mg_sample_genotpyes_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_SAMPLE_LISTS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_IMPORT_GENOTYPES', 'Import Genotypes', @mg_sample_genotpyes_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_IMPORT_GENOTYPES');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>


	<changeSet author="cuenyad" id="v23.4.0-40">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_SAMPLE_GENOTYPES';
             </sqlCheck>
 		</preConditions>
        <comment>Add Sample Genotypes permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @mg_studies_permission_id = (SELECT permission_id FROM permission WHERE name = 'MANAGE_STUDIES');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_SAMPLE_GENOTYPES', 'Sample Genotypes', @mg_studies_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_SAMPLE_GENOTYPES');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-41">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_VIEW_SAMPLE_GENOTYPES';
             </sqlCheck>
 		</preConditions>
        <comment>Add View Sample Genotpyes permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @mg_sample_genotpyes_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_SAMPLE_GENOTYPES');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_VIEW_SAMPLE_GENOTYPES', 'View Sample Genotypes', @mg_sample_genotpyes_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_VIEW_SAMPLE_GENOTYPES');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-42">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_SSA_RESULTS';
             </sqlCheck>
 		</preConditions>
        <comment>Add SSA Results permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @mg_studies_permission_id = (SELECT permission_id FROM permission WHERE name = 'MANAGE_STUDIES');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_SSA_RESULTS', 'SSA Results', @mg_studies_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_SSA_RESULTS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-43">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_VIEW_SSA_RESULTS';
             </sqlCheck>
 		</preConditions>
        <comment>Add View SSA Results permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ssa_results_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_SSA_RESULTS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_VIEW_SSA_RESULTS', 'View SSA Results', @ssa_results_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_VIEW_SSA_RESULTS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-44">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_SSA_SUMMARY_STATISTICS';
             </sqlCheck>
 		</preConditions>
        <comment>Add Summary Statistics permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ssa_results_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_SSA_RESULTS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_SSA_SUMMARY_STATISTICS', 'Summary Statistics', @ssa_results_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_SSA_SUMMARY_STATISTICS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-45">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_SSA_MEANS_BLUE';
             </sqlCheck>
 		</preConditions>
        <comment>Add Means (BLUES) permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ssa_results_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_SSA_RESULTS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_SSA_MEANS_BLUE', 'Means (BLUES)', @ssa_results_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_SSA_MEANS_BLUE');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-46">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_OBSERVATIONS';
             </sqlCheck>
 		</preConditions>
        <comment>Add Observations permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @mg_studies_permission_id = (SELECT permission_id FROM permission WHERE name = 'MANAGE_STUDIES');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_OBSERVATIONS', 'Observations', @mg_studies_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_OBSERVATIONS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-47">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_VIEW_OBSERVATIONS';
             </sqlCheck>
 		</preConditions>
        <comment>Add View Observations permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @observation_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_OBSERVATIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_VIEW_OBSERVATIONS', 'View Observations', @observation_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_VIEW_OBSERVATIONS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-48">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_ADD_OBSERVATION_TRAIT_VARIABLES';
             </sqlCheck>
 		</preConditions>
        <comment>Add trait variables permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @observation_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_OBSERVATIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_ADD_OBSERVATION_TRAIT_VARIABLES', 'Add trait variables', @observation_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_ADD_OBSERVATION_TRAIT_VARIABLES');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-49">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_ADD_OBSERVATION_SELECTION_VARIABLES';
             </sqlCheck>
 		</preConditions>
        <comment>Add Selection variables permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @observation_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_OBSERVATIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_ADD_OBSERVATION_SELECTION_VARIABLES', 'Add Selection variables', @observation_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_ADD_OBSERVATION_SELECTION_VARIABLES');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>


	<changeSet author="cuenyad" id="v23.4.0-50">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_MANAGE_PENDING_OBSERVATIONS';
             </sqlCheck>
 		</preConditions>
		<comment>Add Manage pending observations permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @observation_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_OBSERVATIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_MANAGE_PENDING_OBSERVATIONS', 'Manage pending observations', @observation_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_MANAGE_PENDING_OBSERVATIONS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-51">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_MANAGE_CONFIRMED_OBSERVATIONS';
             </sqlCheck>
 		</preConditions>
		<comment>Add Manage confirmed observations permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @observation_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_OBSERVATIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_MANAGE_CONFIRMED_OBSERVATIONS', 'Manage confirmed observations', @observation_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_MANAGE_CONFIRMED_OBSERVATIONS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-52">
         <preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_ACCEPT_PENDING_OBSERVATION';
             </sqlCheck>
 		</preConditions>
		<comment>Add Accept pending observations permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @observation_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_OBSERVATIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_ACCEPT_PENDING_OBSERVATION', 'Accept pending observations', @observation_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_ACCEPT_PENDING_OBSERVATION');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-53">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_STUDY_ACTIONS';
             </sqlCheck>
 		</preConditions>
        <comment>Add Study Actions permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @mg_studies_permission_id = (SELECT permission_id FROM permission WHERE name = 'MANAGE_STUDIES');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_STUDY_ACTIONS', 'Study Actions', @mg_studies_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_STUDY_ACTIONS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-54">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="1">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_CREATE_LOTS' AND
						 P.PARENT_ID = ( SELECT PERMISSION_ID FROM PERMISSION WHERE NAME = 'MANAGE_STUDIES');
             </sqlCheck>
 		</preConditions>
        <comment>Add Update the parent id of MS_CREATE_LOTS by MS_STUDY_ACTIONS permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_study_actions_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_STUDY_ACTIONS');
			SET @mg_create_lots_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_CREATE_LOTS');
			update permission set parent_id = @ms_study_actions_permission_id where permission_id = @mg_create_lots_permission_id
 		</sql>
 	</changeSet>


	<changeSet author="cuenyad" id="v23.4.0-55">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="1">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_MANAGE_OBSERVATION_UNITS' AND
						 P.PARENT_ID = ( SELECT PERMISSION_ID FROM PERMISSION WHERE NAME = 'MANAGE_STUDIES');
             </sqlCheck>
 		</preConditions>
        <comment>Add Update the parent id of MS_MANAGE_OBSERVATION_UNITS by MS_STUDY_ACTIONS permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_study_actions_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_STUDY_ACTIONS');
			SET @mg_observation_units_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_MANAGE_OBSERVATION_UNITS');
			update permission set parent_id = @ms_study_actions_permission_id where permission_id = @mg_observation_units_permission_id
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-56">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_CREATE_GENOTYPING_SAMPLES';
             </sqlCheck>
 		</preConditions>
        <comment>Add Create Genotyping Samples permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_study_actions_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_STUDY_ACTIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_CREATE_GENOTYPING_SAMPLES', 'Create Genotyping Samples', @ms_study_actions_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_CREATE_GENOTYPING_SAMPLES');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-57">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_EXECUTE_CALCULATED_VARIABLES';
             </sqlCheck>
 		</preConditions>
        <comment>Add Execute calculated variables permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_study_actions_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_STUDY_ACTIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_EXECUTE_CALCULATED_VARIABLES', 'Execute Calculated Variables', @ms_study_actions_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_EXECUTE_CALCULATED_VARIABLES');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-58">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_DESIGN_AND_PLANNING_OPTIONS';
             </sqlCheck>
 		</preConditions>
        <comment>Add Design and planning options permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_study_actions_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_STUDY_ACTIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_DESIGN_AND_PLANNING_OPTIONS', 'Design and Planning Options', @ms_study_actions_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_DESIGN_AND_PLANNING_OPTIONS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-59">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_EXPORT_DESIGN_TEMPLATE';
             </sqlCheck>
 		</preConditions>
        <comment>Add Export design template permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_design_and_planning_options_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_DESIGN_AND_PLANNING_OPTIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_EXPORT_DESIGN_TEMPLATE', 'Export Design Template', @ms_design_and_planning_options_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_EXPORT_DESIGN_TEMPLATE');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-60">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_CREATE_PLANTING_LABELS';
             </sqlCheck>
 		</preConditions>
        <comment>Add Create planting labels permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_design_and_planning_options_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_DESIGN_AND_PLANNING_OPTIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_CREATE_PLANTING_LABELS', 'Create Planting Labels', @ms_design_and_planning_options_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_CREATE_PLANTING_LABELS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-61">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_ADVANCES';
             </sqlCheck>
 		</preConditions>
        <comment>Add Advances permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_study_actions_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_STUDY_ACTIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_ADVANCES', 'Advances', @ms_study_actions_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_ADVANCES');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-62">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_ADVANCE_STUDY';
             </sqlCheck>
 		</preConditions>
        <comment>Add Advance Study permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_advances_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_ADVANCES');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_ADVANCE_STUDY', 'Advance Study', @ms_advances_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_ADVANCE_STUDY');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-63">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_ADVANCE_STUDY_FOR_PLANTS';
             </sqlCheck>
 		</preConditions>
        <comment>Add Advance study From Plants permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_advances_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_ADVANCES');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_ADVANCE_STUDY_FOR_PLANTS', 'Advance Study From Plants', @ms_advances_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_ADVANCE_STUDY_FOR_PLANTS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-64">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_ANALYZE_WITH_STA_BRAPP';
             </sqlCheck>
 		</preConditions>
        <comment>Add Analyze with STA BrAPP permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_study_actions_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_STUDY_ACTIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_ANALYZE_WITH_STA_BRAPP', 'Analyze with STA BrAPP', @ms_study_actions_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_ANALYZE_WITH_STA_BRAPP');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-65">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_ANALYZE_WITH_DECISION_SUPPORT';
             </sqlCheck>
 		</preConditions>
        <comment>Add Analyze with Decision Support permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_study_actions_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_STUDY_ACTIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_ANALYZE_WITH_DECISION_SUPPORT', 'Analyze with Decision Support', @ms_study_actions_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_ANALYZE_WITH_DECISION_SUPPORT');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-66">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_CREATE_SUB_OBSERVATION_UNITS';
             </sqlCheck>
 		</preConditions>
        <comment>Add Create Sub-observation Units permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_manage_observation_units_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_MANAGE_OBSERVATION_UNITS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_CREATE_SUB_OBSERVATION_UNITS', 'Create Sub-observation Units', @ms_manage_observation_units_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_CREATE_SUB_OBSERVATION_UNITS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-67">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_CHANGE_PLOT_ENTRY';
             </sqlCheck>
 		</preConditions>
        <comment>Add Change Plot Entry permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_manage_observation_units_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_MANAGE_OBSERVATION_UNITS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_CHANGE_PLOT_ENTRY', 'Change Plot Entry', @ms_manage_observation_units_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_CHANGE_PLOT_ENTRY');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-68">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_EXPORT_STUDY_BOOK';
             </sqlCheck>
 		</preConditions>
        <comment>Add Export Study Book permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_manage_observation_units_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_MANAGE_OBSERVATION_UNITS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_EXPORT_STUDY_BOOK', 'Export Study Book', @ms_manage_observation_units_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_EXPORT_STUDY_BOOK');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-69">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_EXPORT_STUDY_ENTRIES';
             </sqlCheck>
 		</preConditions>
        <comment>Add Export Study Entries permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_manage_observation_units_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_MANAGE_OBSERVATION_UNITS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_EXPORT_STUDY_ENTRIES', 'Export Study Entries', @ms_manage_observation_units_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_EXPORT_STUDY_ENTRIES');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-70">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="1">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_MANAGE_FILES';
             </sqlCheck>
 		</preConditions>
		<comment>Add Update the parent id of MS_MANAGE_FILES by MS_OBSERVATIONS permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_manage_file_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_MANAGE_FILES');
			SET @observation_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_OBSERVATIONS');

			update permission set parent_id = @observation_permission_id  where permission_id = @ms_manage_file_permission_id
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-71">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="1">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_MANAGE_FILES';
             </sqlCheck>
 		</preConditions>
		<comment>Renaming MS_MANAGE_FILES permission as MS_MANAGE_FILES_OBSERVATIONS</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_manage_file_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_MANAGE_FILES');

			update permission set name = 'MS_MANAGE_FILES_OBSERVATIONS ', description='Manage Files Observations'  where permission_id = @ms_manage_file_permission_id
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-72">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_CROSSING_OPTIONS';
             </sqlCheck>
 		</preConditions>
        <comment>Add Crossing Options permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_study_actions_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_STUDY_ACTIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_CROSSING_OPTIONS', 'Crossing Options', @ms_study_actions_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_CROSSING_OPTIONS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-73">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_EXPORT_CROSSING_TEMPLATE';
             </sqlCheck>
 		</preConditions>
        <comment>Add Export Crossing Template permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_crossing_options_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_CROSSING_OPTIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_EXPORT_CROSSING_TEMPLATE', 'Export Crossing Template', @ms_crossing_options_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_EXPORT_CROSSING_TEMPLATE');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-74">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_IMPORT_CROSSES';
             </sqlCheck>
 		</preConditions>
        <comment>Add Import Crosses permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_crossing_options_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_CROSSING_OPTIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_IMPORT_CROSSES', 'Import Crosses', @ms_crossing_options_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_IMPORT_CROSSES');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-75">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_DESIGN_NEW_CROSSES';
             </sqlCheck>
 		</preConditions>
        <comment>Add Design New Crosses permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_crossing_options_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_CROSSING_OPTIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_DESIGN_NEW_CROSSES', 'Design New Crosses', @ms_crossing_options_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_DESIGN_NEW_CROSSES');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-76">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_FIELD_MAP_OPTIONS';
             </sqlCheck>
 		</preConditions>
        <comment>Add Field Map options permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_study_actions_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_STUDY_ACTIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_FIELD_MAP_OPTIONS', 'Field Map Options', @ms_study_actions_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_FIELD_MAP_OPTIONS');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-77">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_MAKE_FIELD_MAP';
             </sqlCheck>
 		</preConditions>
        <comment>Add Make Field Map permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_field_map_options_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_FIELD_MAP_OPTIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_MAKE_FIELD_MAP', 'Make Field Map', @ms_field_map_options_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_MAKE_FIELD_MAP');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-78">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_VIEW_FIELD_MAP';
             </sqlCheck>
 		</preConditions>
        <comment>Add View Field Map permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_field_map_options_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_FIELD_MAP_OPTIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_VIEW_FIELD_MAP', 'View Field Map', @ms_field_map_options_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_VIEW_FIELD_MAP');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-79">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_DELETE_FIELD_MAP';
             </sqlCheck>
 		</preConditions>
        <comment>Add Delete Field Map permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_field_map_options_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_FIELD_MAP_OPTIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_DELETE_FIELD_MAP', 'Delete Field Map', @ms_field_map_options_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_DELETE_FIELD_MAP');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-80">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_CREATE_GEOREFERENCE';
             </sqlCheck>
 		</preConditions>
        <comment>Add Create Georeference permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_field_map_options_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_FIELD_MAP_OPTIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_CREATE_GEOREFERENCE', 'Create Georeference', @ms_field_map_options_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_CREATE_GEOREFERENCE');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-81">
		<preConditions onFail="MARK_RAN">
 			<sqlCheck expectedResult="0">
                 SELECT COUNT(*) FROM PERMISSION P WHERE P.NAME = 'MS_EDIT_GEOREFERENCE';
             </sqlCheck>
 		</preConditions>
        <comment>Add Edit Georeference permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @ms_field_map_options_permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_FIELD_MAP_OPTIONS');

			INSERT INTO permission (`name`, `description`, `parent_id`) VALUES ('MS_EDIT_GEOREFERENCE', 'Edit Georeference', @ms_field_map_options_permission_id);

			SET @permission_id = (SELECT permission_id FROM permission WHERE name = 'MS_EDIT_GEOREFERENCE');

			insert into role_type_permission(role_type_id, permission_id, selectable) values (1, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (2, @permission_id , 1);
			insert into role_type_permission(role_type_id, permission_id, selectable) values (3, @permission_id , 1);
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-82">
		<preConditions onFail="MARK_RAN">
			<not>
				<columnExists tableName="permission" columnName="rank"/>
			</not>
		</preConditions>
        <comment>Adding Rank column to permission table</comment>
 		<sql dbms="mysql" splitStatements="true">
			ALTER TABLE PERMISSION
				ADD COLUMN rank INT(11) NOT NULL AFTER workbench_sidebar_category_link_id;
			UPDATE PERMISSION set rank = 1;
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-83">
		<preConditions onFail="MARK_RAN">
			<and>
				<tableExists tableName="permission"/>
				<columnExists tableName="permission" columnName="rank"/>
			</and>
		</preConditions>
        <comment>Reorder Manage Studies rank permissions</comment>
 		<sql dbms="mysql" splitStatements="true">
			UPDATE	PERMISSION	SET	RANK =	1	WHERE	NAME =	'VIEW_STUDIES';
			UPDATE	PERMISSION	SET	RANK =	2	WHERE	NAME =	'CREATE_STUDIES';
			UPDATE	PERMISSION	SET	RANK =	3	WHERE	NAME =	'CLOSE_STUDY';
			UPDATE	PERMISSION	SET	RANK =	4	WHERE	NAME =	'DELETE_STUDY';
			UPDATE	PERMISSION	SET	RANK =	5	WHERE	NAME =	'LOCK_STUDY';
			UPDATE	PERMISSION	SET	RANK =	6	WHERE	NAME =	'MS_GERMPLASM_AND_CHECKS';
			UPDATE	PERMISSION	SET	RANK =	1	WHERE	NAME =	'MS_VIEW_GERMPLASM_AND_CHECKS';
			UPDATE	PERMISSION	SET	RANK =	2	WHERE	NAME =	'MS_ADD_ENTRY_DETAILS_VARIABLES';
			UPDATE	PERMISSION	SET	RANK =	3	WHERE	NAME =	'MS_MODIFY_ENTRY_DETAILS_VALUES';
			UPDATE	PERMISSION	SET	RANK =	4	WHERE	NAME =	'MS_IMPORT_ENTRY_DETAILS';
			UPDATE	PERMISSION	SET	RANK =	5	WHERE	NAME =	'MS_MODIFY_COLUMNS';
			UPDATE	PERMISSION	SET	RANK =	6	WHERE	NAME =	'MS_REPLACE_GERMPLASM';
			UPDATE	PERMISSION	SET	RANK =	7	WHERE	NAME =	'MS_ADD_NEW_ENTRIES';
			UPDATE	PERMISSION	SET	RANK =	7	WHERE	NAME =	'MS_TREATMENT_FACTORS';
			UPDATE	PERMISSION	SET	RANK =	1	WHERE	NAME =	'MS_VIEW_TREATMENT_FACTORS';
			UPDATE	PERMISSION	SET	RANK =	2	WHERE	NAME =	'MS_ADD_TREATMENT_FACTORS_VARIABLES';
			UPDATE	PERMISSION	SET	RANK =	8	WHERE	NAME =	'MS_EXPERIMENTAL_DESIGN';
			UPDATE	PERMISSION	SET	RANK =	1	WHERE	NAME =	'MS_VIEW_EXPERIMENTAL_DESIGN';
			UPDATE	PERMISSION	SET	RANK =	2	WHERE	NAME =	'MS_GENERATE_EXPERIMENTAL_DESIGN';
			UPDATE	PERMISSION	SET	RANK =	3	WHERE	NAME =	'MS_DELETE_EXPERIMENTAL_DESIGN';
			UPDATE	PERMISSION	SET	RANK =	9	WHERE	NAME =	'MS_ENVIRONMENT';
			UPDATE	PERMISSION	SET	RANK =	1	WHERE	NAME =	'MS_VIEW_ENVIRONMENT';
			UPDATE	PERMISSION	SET	RANK =	2	WHERE	NAME =	'MS_ADD_ENVIRONMENTAL_CONDITIONS_VARIABLES';
			UPDATE	PERMISSION	SET	RANK =	3	WHERE	NAME =	'MS_ADD_ENVIRONMENT_DETAILS_VARIABLES';
			UPDATE	PERMISSION	SET	RANK =	4	WHERE	NAME =	'MS_MODIFY_ENVIRONMENT_VALUES';
			UPDATE	PERMISSION	SET	RANK =	5	WHERE	NAME =	'MS_MODIFY_NUMBER_OF_ENVIRONMENT';
			UPDATE	PERMISSION	SET	RANK =	6	WHERE	NAME =	'MS_MANAGE_FILES_ENVIRONMENT';
			UPDATE	PERMISSION	SET	RANK =	10	WHERE	NAME =	'MS_STUDY_SETTINGS';
			UPDATE	PERMISSION	SET	RANK =	1	WHERE	NAME =	'MS_VIEW_STUDY_SETTINGS';
			UPDATE	PERMISSION	SET	RANK =	2	WHERE	NAME =	'MS_ADD_STUDY_SETTINGS_VARIABLES';
			UPDATE	PERMISSION	SET	RANK =	11	WHERE	NAME =	'MS_OBSERVATIONS';
			UPDATE	PERMISSION	SET	RANK =	1	WHERE	NAME =	'MS_VIEW_OBSERVATIONS';
			UPDATE	PERMISSION	SET	RANK =	2	WHERE	NAME =	'MS_ADD_OBSERVATION_TRAIT_VARIABLES';
			UPDATE	PERMISSION	SET	RANK =	3	WHERE	NAME =	'MS_ADD_OBSERVATION_SELECTION_VARIABLES';
			UPDATE	PERMISSION	SET	RANK =	4	WHERE	NAME =	'MS_MANAGE_PENDING_OBSERVATIONS';
			UPDATE	PERMISSION	SET	RANK =	5	WHERE	NAME =	'MS_MANAGE_CONFIRMED_OBSERVATIONS';
			UPDATE	PERMISSION	SET	RANK =	6	WHERE	NAME =	'MS_ACCEPT_PENDING_OBSERVATION';
			UPDATE	PERMISSION	SET	RANK =	7	WHERE	NAME =	'MS_MANAGE_FILES_OBSERVATIONS';
			UPDATE	PERMISSION	SET	RANK =	12	WHERE	NAME =	'MS_CROSSES_AND_SELECTIONS';
			UPDATE	PERMISSION	SET	RANK =	1	WHERE	NAME =	'MS_VIEW_CROSSES_AND_SELECTIONS';
			UPDATE	PERMISSION	SET	RANK =	13	WHERE	NAME =	'MS_SAMPLE_LISTS';
			UPDATE	PERMISSION	SET	RANK =	1	WHERE	NAME =	'MS_VIEW_SAMPLE_LIST';
			UPDATE	PERMISSION	SET	RANK =	2	WHERE	NAME =	'MS_EXPORT_SAMPLE_LIST';
			UPDATE	PERMISSION	SET	RANK =	3	WHERE	NAME =	'MS_DELETE_SAMPLES';
			UPDATE	PERMISSION	SET	RANK =	4	WHERE	NAME =	'MS_IMPORT_GENOTYPES';
			UPDATE	PERMISSION	SET	RANK =	14	WHERE	NAME =	'MS_SAMPLE_GENOTYPES';
			UPDATE	PERMISSION	SET	RANK =	1	WHERE	NAME =	'MS_VIEW_SAMPLE_GENOTYPES';
			UPDATE	PERMISSION	SET	RANK =	15	WHERE	NAME =	'MS_INVENTORY';
			UPDATE	PERMISSION	SET	RANK =	1	WHERE	NAME =	'MS_VIEW_INVENTORY';
			UPDATE	PERMISSION	SET	RANK =	16	WHERE	NAME =	'MS_SSA_RESULTS';
			UPDATE	PERMISSION	SET	RANK =	1	WHERE	NAME =	'MS_VIEW_SSA_RESULTS';
			UPDATE	PERMISSION	SET	RANK =	2	WHERE	NAME =	'MS_SSA_SUMMARY_STATISTICS';
			UPDATE	PERMISSION	SET	RANK =	3	WHERE	NAME =	'MS_SSA_MEANS_BLUE';
			UPDATE	PERMISSION	SET	RANK =	17	WHERE	NAME =	'MS_STUDY_ACTIONS';
			UPDATE	PERMISSION	SET	RANK =	1	WHERE	NAME =	'MS_DESIGN_AND_PLANNING_OPTIONS';
			UPDATE	PERMISSION	SET	RANK =	1	WHERE	NAME =	'MS_EXPORT_DESIGN_TEMPLATE';
			UPDATE	PERMISSION	SET	RANK =	2	WHERE	NAME =	'MS_CREATE_PLANTING_LABELS';
			UPDATE	PERMISSION	SET	RANK =	2	WHERE	NAME =	'MS_CROSSING_OPTIONS';
			UPDATE	PERMISSION	SET	RANK =	1	WHERE	NAME =	'MS_EXPORT_CROSSING_TEMPLATE';
			UPDATE	PERMISSION	SET	RANK =	2	WHERE	NAME =	'MS_IMPORT_CROSSES';
			UPDATE	PERMISSION	SET	RANK =	3	WHERE	NAME =	'MS_DESIGN_NEW_CROSSES';
			UPDATE	PERMISSION	SET	RANK =	3	WHERE	NAME =	'MS_MANAGE_OBSERVATION_UNITS';
			UPDATE	PERMISSION	SET	RANK =	1	WHERE	NAME =	'MS_WITHDRAW_INVENTORY';
			UPDATE	PERMISSION	SET	RANK =	1	WHERE	NAME =	'MS_CREATE_PENDING_WITHDRAWALS';
			UPDATE	PERMISSION	SET	RANK =	2	WHERE	NAME =	'MS_CREATE_CONFIRMED_WITHDRAWALS';
			UPDATE	PERMISSION	SET	RANK =	3	WHERE	NAME =	'MS_CANCEL_PENDING_TRANSACTIONS';
			UPDATE	PERMISSION	SET	RANK =	2	WHERE	NAME =	'MS_CREATE_SUB_OBSERVATION_UNITS';
			UPDATE	PERMISSION	SET	RANK =	3	WHERE	NAME =	'MS_CHANGE_PLOT_ENTRY';
			UPDATE	PERMISSION	SET	RANK =	4	WHERE	NAME =	'MS_EXPORT_STUDY_ENTRIES';
			UPDATE	PERMISSION	SET	RANK =	5	WHERE	NAME =	'MS_EXPORT_STUDY_BOOK';
			UPDATE	PERMISSION	SET	RANK =	4	WHERE	NAME =	'MS_CREATE_LOTS';
			UPDATE	PERMISSION	SET	RANK =	5	WHERE	NAME =	'MS_FIELD_MAP_OPTIONS';
			UPDATE	PERMISSION	SET	RANK =	1	WHERE	NAME =	'MS_MAKE_FIELD_MAP';
			UPDATE	PERMISSION	SET	RANK =	2	WHERE	NAME =	'MS_VIEW_FIELD_MAP';
			UPDATE	PERMISSION	SET	RANK =	3	WHERE	NAME =	'MS_DELETE_FIELD_MAP';
			UPDATE	PERMISSION	SET	RANK =	4	WHERE	NAME =	'MS_CREATE_GEOREFERENCE';
			UPDATE	PERMISSION	SET	RANK =	5	WHERE	NAME =	'MS_EDIT_GEOREFERENCE';
			UPDATE	PERMISSION	SET	RANK =	6	WHERE	NAME =	'MS_EXECUTE_CALCULATED_VARIABLES';
			UPDATE	PERMISSION	SET	RANK =	7	WHERE	NAME =	'MS_CREATE_GENOTYPING_SAMPLES';
			UPDATE	PERMISSION	SET	RANK =	8	WHERE	NAME =	'MS_ADVANCES';
			UPDATE	PERMISSION	SET	RANK =	1	WHERE	NAME =	'MS_ADVANCE_STUDY';
			UPDATE	PERMISSION	SET	RANK =	2	WHERE	NAME =	'MS_ADVANCE_STUDY_FOR_PLANTS';
			UPDATE	PERMISSION	SET	RANK =	9	WHERE	NAME =	'MS_ANALYZE_WITH_STA_BRAPP';
			UPDATE	PERMISSION	SET	RANK =	10	WHERE	NAME =	'MS_ANALYZE_WITH_DECISION_SUPPORT';
 		</sql>
 	</changeSet>

	<changeSet author="cuenyad" id="v23.4.0-84">
         <preConditions onFail="MARK_RAN">
			<and>
            	<sqlCheck expectedResult="1">
                	SELECT count(*) > 1 FROM role_permission rp INNER JOIN permission p ON rp.permission_id = p.permission_id
					WHERE p.name IN ('MS_MANAGE_OBSERVATION_UNITS','MS_WITHDRAW_INVENTORY',
							 'MS_CREATE_PENDING_WITHDRAWALS','MS_CREATE_CONFIRMED_WITHDRAWALS',
							 'MS_CANCEL_PENDING_TRANSACTIONS','MS_MANAGE_FILES','MS_CREATE_LOTS');
            	</sqlCheck>
				<not>
					<tableExists tableName="roles_affected_temporary"></tableExists>
				</not>
			</and>
 		</preConditions>
		<comment>Adding new granular studies permissions in role_permission</comment>
 		<sql dbms="mysql" splitStatements="true">
			SET @manage_studies_permission_id = (SELECT permission_id FROM permission WHERE name = 'MANAGE_STUDIES');

			#Create roles_affected_temporary Table
			CREATE TEMPORARY TABLE roles_affected_temporary (
				role_id int(11) not null
			);

			#Insert role id in Temporary table
			INSERT INTO roles_affected_temporary (role_id)
			SELECT DISTINCT(rp.role_id) FROM role_permission rp INNER JOIN  permission p ON rp.permission_id = p.permission_id
			WHERE p.name IN ('MS_MANAGE_OBSERVATION_UNITS','MS_WITHDRAW_INVENTORY',
							 'MS_CREATE_PENDING_WITHDRAWALS','MS_CREATE_CONFIRMED_WITHDRAWALS',
							 'MS_CANCEL_PENDING_TRANSACTIONS','MS_MANAGE_FILES','MS_CREATE_LOTS')
			GROUP BY rp.role_id;


			#Delete the permissions that has permission as a parent.
			DELETE FROM role_permission WHERE role_id in (SELECT ROLE.ID FROM (
				SELECT DISTINCT(rp.role_id) AS ID FROM role_permission rp INNER JOIN  permission p ON rp.permission_id = p.permission_id
					WHERE p.name IN ('MS_MANAGE_OBSERVATION_UNITS','MS_WITHDRAW_INVENTORY',
							 'MS_CREATE_PENDING_WITHDRAWALS','MS_CREATE_CONFIRMED_WITHDRAWALS',
							 'MS_CANCEL_PENDING_TRANSACTIONS','MS_MANAGE_FILES','MS_CREATE_LOTS')) AS ROLE);

			#Insert permissions in role_permission
			INSERT INTO role_permission(role_id, permission_id)
			SELECT rp.role_id, @manage_studies_permission_id FROM roles_affected_temporary rp;

			#Delete roles_affected_temporary Table
			DROP TABLE roles_affected_temporary;


 		</sql>
 	</changeSet>

</databaseChangeLog>
