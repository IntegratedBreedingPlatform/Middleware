<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
		http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.5.xsd">

    <changeSet author="cuenyad" id="v9.2.0-1">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="2">
                SELECT COUNT(*) FROM workbench_sidebar_category_link WHERE sidebar_category_link_id IN (3,4);
            </sqlCheck>
        </preConditions>
        <comment>Removing Nursery and Trial Manager side menu</comment>
        <sql dbms="mysql" splitStatements="true">
            DELETE FROM workbench_sidebar_category_link WHERE sidebar_category_link_id IN (3,4);
        </sql>
    </changeSet>
    <changeSet author="cuenyad" id="v9.2.0-2">
		<preConditions onFail="MARK_RAN">
			<sqlCheck expectedResult="1">
				SELECT COUNT(*) = 0 FROM workbench_tool where group_name="study_manager_fieldbook_web";
			</sqlCheck>
		</preConditions>
		<comment>Adding Manager Study</comment>
		<sql dbms="mysql" splitStatements="true">
			INSERT INTO workbench_tool (name, group_name, title, version, tool_type, path)
			VALUES ("study_manager_fieldbook_web", "study_manager_fieldbook_web", "Fieldbook Web - Study Manager", "8.2", "WEB", "Fieldbook/TrialManager");
		</sql>
	</changeSet>
	<changeSet author="cuenyad" id="v9.2.0-3">
		<preConditions onFail="MARK_RAN">
			<sqlCheck expectedResult="0">
				SELECT COUNT(*) FROM workbench_sidebar_category_link where tool_name="study_manager_fieldbook_web";
			</sqlCheck>
		</preConditions>
		<comment>Adding Manager Study</comment>
		<sql dbms="mysql" splitStatements="true">
			INSERT INTO workbench_sidebar_category_link (tool_name, sidebar_category_id, sidebar_link_name, sidebar_link_title) VALUES ('study_manager_fieldbook_web', '1', 'manage_trials', 'Manage Studies');
		</sql>
	</changeSet>
</databaseChangeLog>
