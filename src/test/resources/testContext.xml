<?xml version="1.0" encoding="ISO-8859-1"?>

<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
	xmlns:tx="http://www.springframework.org/schema/tx" xmlns:aop="http://www.springframework.org/schema/aop"

	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
						http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.2.xsd
						http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.2.xsd
						http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.2.xsd">

	<context:property-placeholder location="classpath:test.properties" />

	<context:annotation-config />

	<tx:annotation-driven />

	<bean id="xaDataSources" class="org.generationcp.middleware.hibernate.XADataSources" />

	<bean id="atomikosTransactionManager" class="com.atomikos.icatch.jta.UserTransactionManager"
		init-method="init" destroy-method="close">
		<property name="forceShutdown" value="false" />
	</bean>

	<bean id="atomikosUserTransaction" class="com.atomikos.icatch.jta.J2eeUserTransaction">
		<property name="transactionTimeout" value="${test.atomikos.transaction.timeout}" />
	</bean>

	<bean id="transactionManager"
		class="org.springframework.transaction.jta.JtaTransactionManager"
		depends-on="atomikosTransactionManager,atomikosUserTransaction">
		<property name="transactionManager" ref="atomikosTransactionManager" />
		<property name="userTransaction" ref="atomikosUserTransaction" />
	</bean>

	<bean id="workbenchDataManager"
		class="org.generationcp.middleware.manager.WorkbenchDataManagerImpl"
		destroy-method="close">
		<constructor-arg ref="workbenchSessionProvider" />
	</bean>

	<bean id="workbenchSessionProvider"
		class="org.generationcp.middleware.hibernate.HibernateSessionPerRequestProvider">
		<property name="sessionFactory" ref="WORKBENCH_SessionFactory" />
	</bean>

    <bean id="ontologyDataManager" class="org.generationcp.middleware.manager.OntologyDataManagerImpl">
        <property name="sessionProvider" ref="cropSessionProvider"/>
    </bean>

    <bean id="userDataManager" class="org.generationcp.middleware.manager.UserDataManagerImpl">
        <property name="sessionProvider" ref="cropSessionProvider"/>
    </bean>

    <bean id="germplasmDataManager" class="org.generationcp.middleware.manager.GermplasmDataManagerImpl">
        <property name="sessionProvider" ref="cropSessionProvider"/>
    </bean>

    <bean id="germplasmListManager" class="org.generationcp.middleware.manager.GermplasmListManagerImpl">
        <property name="sessionProvider" ref="cropSessionProvider"/>
    </bean>

	<bean id="germplasmGroupingService" class="org.generationcp.middleware.service.impl.GermplasmGroupingServiceImpl">
	</bean>
	
	<bean id="dummyCrossExpansionProps" class="java.util.Properties">
	</bean>
	
	<bean id="crossExpansionProperties"
		class="org.generationcp.middleware.util.CrossExpansionProperties">
		<constructor-arg ref="dummyCrossExpansionProps" />
	</bean>
	
    <bean id="oldPedigreeService" class="org.generationcp.middleware.service.pedigree.PedigreeDefaultServiceImpl">
        <constructor-arg ref="cropSessionProvider"/>
        <constructor-arg value="maize"/>
    </bean>

    <bean id="pedigreeService" class="org.generationcp.middleware.service.pedigree.PedigreeServiceImpl">
        <constructor-arg ref="cropSessionProvider"/>
        <constructor-arg value="maize"/>
    </bean>

    <bean id="pedigreeDataManager" class="org.generationcp.middleware.manager.PedigreeDataManagerImpl">
        <property name="sessionProvider" ref="cropSessionProvider"/>
        <property name="germplasmDataManager" ref="germplasmDataManager"/>
    </bean>

    <bean id="locationDataManager" class="org.generationcp.middleware.manager.LocationDataManagerImpl">
        <property name="sessionProvider" ref="cropSessionProvider"/>
    </bean>

    <bean id="crossStudyDataManager" class="org.generationcp.middleware.manager.CrossStudyDataManagerImpl">
        <property name="sessionProvider" ref="cropSessionProvider"/>
    </bean>

    <bean id="genotypicDataManager" class="org.generationcp.middleware.manager.GenotypicDataManagerImpl">
        <property name="sessionProvider" ref="cropSessionProvider"/>
    </bean>

    <bean id="inventoryDataManager" class="org.generationcp.middleware.manager.InventoryDataManagerImpl">
        <property name="sessionProvider" ref="cropSessionProvider"/>
    </bean>

    <bean id="inventoryService" class="org.generationcp.middleware.service.InventoryServiceImpl">
        <constructor-arg ref="cropSessionProvider"/>
    </bean>

    <bean id="presetDataManager" class="org.generationcp.middleware.manager.PresetDataManagerImpl">
        <property name="sessionProvider" ref="cropSessionProvider"/>
    </bean>

    <bean id="studyDataManager" class="org.generationcp.middleware.manager.StudyDataManagerImpl">
        <property name="sessionProvider" ref="cropSessionProvider"/>
    </bean>

    <bean id="userProgramStateDataManager" class="org.generationcp.middleware.manager.UserProgramStateDataManagerImpl">
        <property name="sessionProvider" ref="cropSessionProvider"/>
    </bean>

    <bean id="conformityTestingService" class="org.generationcp.middleware.service.ConformityTestingServiceImpl">
    	<constructor-arg ref="genotypicDataManager"/>
    	<constructor-arg ref="pedigreeDataManager"/>
    </bean>

    <bean id="dataImportService" class="org.generationcp.middleware.service.DataImportServiceImpl">
        <property name="sessionProvider" ref="cropSessionProvider"/>
    </bean>

    <bean id="fieldbookService" class="org.generationcp.middleware.service.FieldbookServiceImpl">
        <property name="sessionProvider" ref="cropSessionProvider"/>
    </bean>

    <bean id="MBDTDataManager" class="org.generationcp.middleware.manager.MBDTDataManagerImpl">
        <property name="sessionProvider" ref="cropSessionProvider"/>
    </bean>

    <bean id="reportService" class="org.generationcp.middleware.service.ReportServiceImpl">
        <property name="sessionProvider" ref="cropSessionProvider"/>
    </bean>

    <bean id="ontologyMethodDataManager" class="org.generationcp.middleware.manager.ontology.OntologyMethodDataManagerImpl">
        <constructor-arg name="sessionProvider" ref="cropSessionProvider"/>
    </bean>

    <bean id="ontologyPropertyDataManager" class="org.generationcp.middleware.manager.ontology.OntologyPropertyDataManagerImpl">
        <property name="sessionProvider" ref="cropSessionProvider"/>
    </bean>

    <bean id="ontologyVariableDataManager" class="org.generationcp.middleware.manager.ontology.OntologyVariableDataManagerImpl">
        <property name="sessionProvider" ref="cropSessionProvider"/>
    </bean>

    <bean id="ontologyScaleDataManager" class="org.generationcp.middleware.manager.ontology.OntologyScaleDataManagerImpl">
        <property name="sessionProvider" ref="cropSessionProvider"/>
    </bean>

    <bean id="termDataManager" class="org.generationcp.middleware.manager.ontology.TermDataManagerImpl">
        <property name="sessionProvider" ref="cropSessionProvider"/>
    </bean>

    <bean id="ontologyService" class="org.generationcp.middleware.service.OntologyServiceImpl">
        <property name="sessionProvider" ref="cropSessionProvider"/>
    </bean>

    <bean id="listDataProjectSaver" class="org.generationcp.middleware.operation.saver.ListDataProjectSaver">
        <constructor-arg ref="cropSessionProvider"/>
    </bean>
    
    <bean id="formulaService" class="org.generationcp.middleware.service.impl.derived_variables.FormulaServiceImpl">
        <constructor-arg name="sessionProvider" ref="cropSessionProvider"/>
    </bean>

    <bean id="cropSessionProvider" class="org.generationcp.middleware.hibernate.HibernateSessionPerRequestProvider">
        <property name="sessionFactory" ref="IBDBV2_MAIZE_MERGED_SessionFactory"/>
        <aop:scoped-proxy proxy-target-class="false"/>
    </bean>
</beans>
